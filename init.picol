# -----------------------------------------------------------------------------
#   Initialisation script for offscreen command interpreter
#   Creates proc to take snapshot and record video
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
#   Takes a picture of current frame
# -----------------------------------------------------------------------------
proc image {type fout} {
    set w [width]
    set h [height]
    set pid [execbg ./grab-$type -w $w -h $h -o $fout]
    kill add $pid
}

# -----------------------------------------------------------------------------
#   Video recording
# -----------------------------------------------------------------------------
proc video {type fout nframes} {
    set w [width]
    set h [height]
    set fps [fps]
    set pid [execbg ./h264enc -w $w -h $h -n $nframes -f $fps  -o $fout --rcmode CBR]
    after 500
    colorspace yuv
    kill add $pid
}
